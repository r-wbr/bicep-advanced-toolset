{
    "$schema": "https://schema.management.azure.com/schemas/2021-09-09/uiFormDefinition.schema.json",
    "view": {
      "kind": "Form",
      "properties": {
        "title": "Test Form View",
        "steps": [
          {
            "name": "nameAndRegion",
            "label": "Name and Region",
            "elements": [
              {
                "name": "resourceScope",
                "type": "Microsoft.Common.ResourceScope",
                "location": {
                  "resourceTypes": []
                }
              },
              {
                "name": "formLibrary",
                "type": "Microsoft.Common.TextBox",
                "label": "form Library",
                "subLabel": "",
                "defaultValue": "{\"resourcePrefixList\":\"[variables('$fxv#0')]\",\"regionAffixList\":\"[variables('$fxv#1')]\"}",
                "toolTip": "",
                "constraints": {
                  "required": false,
                  "regex": "",
                  "validationMessage": "",
                  "validations": []
                },
                "infoMessages": [],
                "visible": false
              },
              {
                "name": "deploymentLocation",
                "type": "Microsoft.Common.TextBox",
                "label": "Deployment Location",
                "subLabel": "",
                "defaultValue": "[[deployment().location]",
                "toolTip": "Define parameters to form from deployment values.",
                "constraints": {
                  "required": false,
                  "regex": "",
                  "validationMessage": "",
                  "validations": []
                },
                "infoMessages": [],
                "visible": false
              },
              {
                "name": "deploymentDate",
                "type": "Microsoft.Common.TextBox",
                "label": "Deployment Date",
                "subLabel": "",
                "defaultValue": "[[utcNow('dd.MM.yyyy')]",
                "toolTip": "",
                "constraints": {
                  "required": false,
                  "regex": "",
                  "validationMessage": "",
                  "validations": []
                },
                "infoMessages": [],
                "visible": false
              },
              {
                "name": "formLongName",
                "type": "Microsoft.Common.TextBox",
                "label": "Name",
                "subLabel": "",
                "defaultValue": "",
                "toolTip": "Name of the application, service or workload to which the resource group is associated.",
                "constraints": {
                  "required": true,
                  "regex": "",
                  "validationMessage": "",
                  "validations": []
                },
                "infoMessages": [],
                "visible": true
              },
              {
                "name": "formShortName",
                "type": "Microsoft.Common.TextBox",
                "label": "Abbreviation",
                "subLabel": "",
                "defaultValue": "",
                "toolTip": "Abbreviation of the name selected in the 'Name' field.",
                "constraints": {
                  "required": true,
                  "regex": "",
                  "validationMessage": "",
                  "validations": [
                    {
                      "isValid": "[or(or(empty(steps('nameAndRegion').formShortName),and(not(startsWith(steps('nameAndRegion').formShortName,'[[')),startsWith(steps('nameAndRegion').formShortName,'['),endsWith(steps('nameAndRegion').formShortName,']'),greater(indexOf(steps('nameAndRegion').formShortName,'('),-1),greater(indexOf(steps('nameAndRegion').formShortName,')'),-1))),greaterOrEquals(length(steps('nameAndRegion').formShortName),3))]",
                      "message": "The value must have a length of at least 3."
                    },
                    {
                      "isValid": "[or(or(empty(steps('nameAndRegion').formShortName),and(not(startsWith(steps('nameAndRegion').formShortName,'[[')),startsWith(steps('nameAndRegion').formShortName,'['),endsWith(steps('nameAndRegion').formShortName,']'),greater(indexOf(steps('nameAndRegion').formShortName,'('),-1),greater(indexOf(steps('nameAndRegion').formShortName,')'),-1))),lessOrEquals(length(steps('nameAndRegion').formShortName),10))]",
                      "message": "The value must have a length of at most 10."
                    }
                  ]
                },
                "infoMessages": [],
                "visible": true
              },
              {
                "name": "formLocation",
                "type": "Microsoft.Common.TextBox",
                "label": "form Location",
                "subLabel": "",
                "defaultValue": "[[parameters('deploymentLocation')]",
                "toolTip": "Region in which the resources are to be deployed.",
                "constraints": {
                  "required": false,
                  "regex": "",
                  "validationMessage": "",
                  "validations": []
                },
                "infoMessages": [],
                "visible": false
              },
              {
                "name": "formOwnerName",
                "type": "Microsoft.Common.TextBox",
                "label": "Owner",
                "subLabel": "",
                "defaultValue": "",
                "toolTip": "Name of the person or department who is responsible for the application, workload or service.",
                "constraints": {
                  "required": true,
                  "regex": "",
                  "validationMessage": "",
                  "validations": []
                },
                "infoMessages": [],
                "visible": true
              },
              {
                "name": "formCreatorName",
                "type": "Microsoft.Common.TextBox",
                "label": "Creator",
                "subLabel": "",
                "defaultValue": "",
                "toolTip": "User principal name of the person performing the deployment.",
                "constraints": {
                  "required": true,
                  "regex": "",
                  "validationMessage": "",
                  "validations": []
                },
                "infoMessages": [],
                "visible": true
              }
            ]
          },
          {
            "name": "Environment",
            "label": "Environment",
            "elements": [
              {
                "name": "formEnvironment",
                "type": "Microsoft.Common.OptionsGroup",
                "label": "Environment",
                "subLabel": "",
                "defaultValue": " ",
                "toolTip": "Lifecycle or environment of this application, workload or service.",
                "constraints": {
                  "required": true,
                  "allowedValues": [
                    {
                      "label": "Production",
                      "value": "Production"
                    },
                    {
                      "label": "Staging",
                      "value": "Staging"
                    },
                    {
                      "label": "Testing",
                      "value": "Testing"
                    },
                    {
                      "label": "Development",
                      "value": "Development"
                    }
                  ],
                  "validations": []
                },
                "infoMessages": [],
                "visible": true
              },
              {
                "name": "formBusinessCriticality",
                "type": "Microsoft.Common.OptionsGroup",
                "label": "Business Criticality",
                "subLabel": "",
                "defaultValue": " ",
                "toolTip": "Business criticality of this application, workload or service.",
                "constraints": {
                  "required": true,
                  "allowedValues": [
                    {
                      "label": "Unsupported",
                      "value": "Unsupported"
                    },
                    {
                      "label": "Low",
                      "value": "Low"
                    },
                    {
                      "label": "Medium",
                      "value": "Medium"
                    },
                    {
                      "label": "High",
                      "value": "High"
                    },
                    {
                      "label": "Unit critical",
                      "value": "Unit critical"
                    },
                    {
                      "label": "Mission critical",
                      "value": "Mission critical"
                    }
                  ],
                  "validations": []
                },
                "infoMessages": [],
                "visible": true
              },
              {
                "name": "formDataClassification",
                "type": "Microsoft.Common.OptionsGroup",
                "label": "Data Classification",
                "subLabel": "",
                "defaultValue": " ",
                "toolTip": "Classification of the data processed in the application, workload or service.",
                "constraints": {
                  "required": true,
                  "allowedValues": [
                    {
                      "label": "Public",
                      "value": "Public"
                    },
                    {
                      "label": "Company",
                      "value": "Company"
                    },
                    {
                      "label": "Confidential",
                      "value": "Confidential"
                    },
                    {
                      "label": "Highly confidential",
                      "value": "Highly confidential"
                    }
                  ],
                  "validations": []
                },
                "infoMessages": [],
                "visible": true
              },
              {
                "name": "formCostCenter",
                "type": "Microsoft.Common.TextBox",
                "label": "Cost Center",
                "subLabel": "",
                "defaultValue": "",
                "toolTip": "Name of the cost center to which the resource is associated.",
                "constraints": {
                  "required": true,
                  "regex": "",
                  "validationMessage": "",
                  "validations": []
                },
                "infoMessages": [],
                "visible": true
              }
            ]
          }
        ]
      },
      "outputs": {
        "kind": "Subscription",
        "location": "[steps('nameAndRegion').resourceScope.location.name]",
        "subscriptionId": "[steps('nameAndRegion').resourceScope.subscription.id]",
        "parameters": {
          "formLibrary": "[steps('nameAndRegion').formLibrary]",
          "deploymentLocation": "[steps('nameAndRegion').deploymentLocation]",
          "moduleResourceTags.DeploymentDate": "[steps('nameAndRegion').deploymentDate]",
          "moduleResourceTags.ApplicationName": "[steps('nameAndRegion').formLongName]",
          "applicationName": "[steps('nameAndRegion').formShortName]",
          "deploymentParameters.location": "[steps('nameAndRegion').formLocation]",
          "moduleResourceTags.Environment": "[steps('Environment').formEnvironment]",
          "moduleResourceTags.OwnerName": "[steps('nameAndRegion').formOwnerName]",
          "moduleResourceTags.CreatorName": "[steps('nameAndRegion').formCreatorName]",
          "moduleResourceTags.BusinessCriticality": "[steps('Environment').formBusinessCriticality]",
          "moduleResourceTags.DataClassification": "[steps('Environment').formDataClassification]",
          "moduleResourceTags.CostCenter": "[steps('Environment').formCostCenter]"
        }
      }
    }
  }
  